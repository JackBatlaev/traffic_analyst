# traffic_analyst

Анализатор сетевого трафика, написанный на C с использованием библиотеки libpcap.

## Описание

Программа предназначена для захвата и анализа сетевых пакетов. 
На текущий момент реализован базовый функционал захвата и отображения информации об интерфейсах.

## История версий
### Версия 0.4
*   **Реализован разбор Ethernet-заголовков:**
    *   Создан новый модуль `ethernet_parser` (`ethernet_parser.c` и `ethernet_parser.h`) для инкапсуляции логики разбора Ethernet.
    *   В `ethernet_parser.h` определена структура `parsed_ethernet_header_t` для представления полей Ethernet-заголовка.
    *   Функция `parse_ethernet_header` теперь извлекает и отображает:
        *   MAC-адрес назначения.
        *   MAC-адрес источника.
        *   Значение поля EtherType (тип инкапсулированного протокола) с преобразованием в хостовый порядок байт и идентификацией распространенных протоколов (IPv4, IPv6, ARP).
    *   Функция `packet_handler` вызывает `parse_ethernet_header` для каждого пакета.
    *   Добавлена базовая логика ( `switch` по EtherType) в `packet_handler` для определения следующего протокола и подготовки к его разбору (например, IPv4, ARP).
    *   Временно неиспользуемые переменные для данных следующего уровня (`next_layer_packet`, `next_layer_len`) корректно "заглушены" для избежания предупреждений компилятора.
### Версия 0.3 
*   **Улучшенное отображение времени захвата пакетов:**
    *   Время захвата пакета в `packet_handler` теперь выводится в человекочитаемом формате: `ГГГГ-ММ-ДД ЧЧ:ММ:СС.микросекунды` (используются `localtime_r` и `strftime`).
*   **Отображение MAC-адресов:**
    *   Реализована функция `print_mac_address_sysfs` для получения MAC-адреса сетевого интерфейса из `/sys/class/net/<имя_интерфейса>/address` (специфично для Linux).
    *   Эта функция вызывается в `print_addresses` для отображения MAC-адреса интерфейса.
    *   В `print_addresses` добавлена обработка семейства адресов `AF_PACKET` (значение 17), что позволяет извлекать и отображать MAC-адрес, если он присутствует в списке адресов `pcap_if_t->addresses`.
*   **Прочие улучшения:**
    *   Добавлен необходимый `#include <linux/if_packet.h>` для определения `struct sockaddr_ll`.
    *   Незначительные улучшения в форматировании вывода и обработке ошибок в функциях, связанных с отображением информации об интерфейсах.

### Версия 0.2 
*   Реструктуризация проекта:
    *   Код разделен на `main` и вспомогательные утилиты (`utils.c`, `utils.h`).
    *   Добавлен `Makefile` для автоматизации сборки.
        *   *Замечание:* Были проблемы с первоначальной версией `Makefile` (правило `clean` некорректно вычисляло `OBJS` и могло удалять исходные файлы). Текущая версия исправлена.
*   Добавлена функция для отображения информации о сетевых интерфейсах, включая их IP-адреса.
*   Улучшена логика выбора активного интерфейса для захвата.

### Версия 0.1 
*   Начальная версия.
*   Реализован захват пакетов с первого доступного активного не-loopback сетевого интерфейса.
*   Вывод информации о длине захваченных пакетов и времени захвата.
*   Базовая обработка пакетов (только отображение метаданных).

---

## Планы на будущее (TODO)

*   [x] Реализовать парсинг Ethernet-заголовков.
*   [ ] Реализовать парсинг IP-заголовков (IPv4, IPv6).
*   [ ] Реализовать парсинг TCP/UDP заголовков.
*   [ ] Добавить возможность выбора интерфейса пользователем.
*   [ ] Добавить возможность применения фильтров захвата (BPF).
*   [ ] Сохранение захваченных пакетов в файл .pcap.
*   [ ] Статистика по протоколам.
